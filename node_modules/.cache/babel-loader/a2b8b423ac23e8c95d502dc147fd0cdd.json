{"ast":null,"code":"var _jsxFileName = \"/home/chizaaa/Documents/code-jam/celo-hodler/code-jam/src/pages/home/Home.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Nfts, Header } from '../../components';\nimport { useContractKit } from \"@celo-tools/use-contractkit\";\nimport { useMarketContract } from \"../../hooks/useMarketContract\";\nimport axios from \"axios\";\nimport { ethers } from \"ethers\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Home = () => {\n  _s();\n\n  const {\n    address,\n    connect,\n    performActions\n  } = useContractKit();\n  const marketplace = useMarketContract();\n  const [nfts, setNfts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    if (marketplace) loadNFTs();\n  }, [marketplace]);\n\n  const loadNFTs = async () => {\n    try {\n      const data = await marketplace.methods.fetchMarketItems().call();\n      const items = await Promise.all(data.map(async i => {\n        const tokenUri = await marketplace.methods.tokenURI(i.tokenId).call();\n        const meta = await axios.get(tokenUri);\n        let price = ethers.utils.formatUnits(i.price.toString(), 'ether');\n        return {\n          price,\n          tokenId: Number(i.tokenId),\n          seller: i.seller,\n          owner: i.owner,\n          image: meta.data.image,\n          name: meta.data.name\n        };\n      }));\n      setNfts(items);\n      setLoading(false);\n    } catch (e) {\n      console.log({\n        e\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Nfts, {\n      nfts: nfts,\n      title: \"Hot NFts\",\n      loading: loading\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 10\n  }, this);\n};\n\n_s(Home, \"mEjTcKyjbJ0s+PbBwaqcucsE2mY=\", false, function () {\n  return [useContractKit, useMarketContract];\n});\n\n_c = Home;\nexport default Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useEffect","useState","Nfts","Header","useContractKit","useMarketContract","axios","ethers","Home","address","connect","performActions","marketplace","nfts","setNfts","loading","setLoading","loadNFTs","data","methods","fetchMarketItems","call","items","Promise","all","map","i","tokenUri","tokenURI","tokenId","meta","get","price","utils","formatUnits","toString","Number","seller","owner","image","name","e","console","log"],"sources":["/home/chizaaa/Documents/code-jam/celo-hodler/code-jam/src/pages/home/Home.jsx"],"sourcesContent":["import React, {useEffect, useState} from 'react';\nimport {Nfts, Header, } from '../../components'\nimport {useContractKit} from \"@celo-tools/use-contractkit\";\nimport {useMarketContract} from \"../../hooks/useMarketContract\";\nimport axios from \"axios\";\nimport {ethers} from \"ethers\";\n\nconst Home = () => {\n\n    const {address, connect, performActions} = useContractKit()\n    const marketplace = useMarketContract()\n\n\n    const [nfts, setNfts] = useState([])\n    const [loading, setLoading] = useState(true)\n\n    useEffect(() => {\n        if(marketplace) loadNFTs()\n    }, [marketplace])\n\n\n    const loadNFTs = async ()  =>{\n        try {\n            const data = await marketplace.methods.fetchMarketItems().call()\n            const items = await Promise.all(data.map(async i => {\n                const tokenUri = await marketplace.methods.tokenURI(i.tokenId).call()\n                const meta = await axios.get(tokenUri)\n                let price = ethers.utils.formatUnits(i.price.toString(), 'ether')\n                return {\n                    price,\n                    tokenId: Number(i.tokenId),\n                    seller: i.seller,\n                    owner: i.owner,\n                    image: meta.data.image,\n                    name: meta.data.name\n                }\n            }))\n\n            setNfts(items)\n            setLoading(false)\n        }catch (e) {\n            console.log({e})\n        }finally {\n            setLoading(false)\n        }\n\n    }\n\n  return <div>\n   <Header />\n   <Nfts nfts={nfts} title=\"Hot NFts\" loading={loading}  />\n  </div>;\n};\n\nexport default Home;\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAeC,SAAf,EAA0BC,QAA1B,QAAyC,OAAzC;AACA,SAAQC,IAAR,EAAcC,MAAd,QAA6B,kBAA7B;AACA,SAAQC,cAAR,QAA6B,6BAA7B;AACA,SAAQC,iBAAR,QAAgC,+BAAhC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAAQC,MAAR,QAAqB,QAArB;;;AAEA,MAAMC,IAAI,GAAG,MAAM;EAAA;;EAEf,MAAM;IAACC,OAAD;IAAUC,OAAV;IAAmBC;EAAnB,IAAqCP,cAAc,EAAzD;EACA,MAAMQ,WAAW,GAAGP,iBAAiB,EAArC;EAGA,MAAM,CAACQ,IAAD,EAAOC,OAAP,IAAkBb,QAAQ,CAAC,EAAD,CAAhC;EACA,MAAM,CAACc,OAAD,EAAUC,UAAV,IAAwBf,QAAQ,CAAC,IAAD,CAAtC;EAEAD,SAAS,CAAC,MAAM;IACZ,IAAGY,WAAH,EAAgBK,QAAQ;EAC3B,CAFQ,EAEN,CAACL,WAAD,CAFM,CAAT;;EAKA,MAAMK,QAAQ,GAAG,YAAY;IACzB,IAAI;MACA,MAAMC,IAAI,GAAG,MAAMN,WAAW,CAACO,OAAZ,CAAoBC,gBAApB,GAAuCC,IAAvC,EAAnB;MACA,MAAMC,KAAK,GAAG,MAAMC,OAAO,CAACC,GAAR,CAAYN,IAAI,CAACO,GAAL,CAAS,MAAMC,CAAN,IAAW;QAChD,MAAMC,QAAQ,GAAG,MAAMf,WAAW,CAACO,OAAZ,CAAoBS,QAApB,CAA6BF,CAAC,CAACG,OAA/B,EAAwCR,IAAxC,EAAvB;QACA,MAAMS,IAAI,GAAG,MAAMxB,KAAK,CAACyB,GAAN,CAAUJ,QAAV,CAAnB;QACA,IAAIK,KAAK,GAAGzB,MAAM,CAAC0B,KAAP,CAAaC,WAAb,CAAyBR,CAAC,CAACM,KAAF,CAAQG,QAAR,EAAzB,EAA6C,OAA7C,CAAZ;QACA,OAAO;UACHH,KADG;UAEHH,OAAO,EAAEO,MAAM,CAACV,CAAC,CAACG,OAAH,CAFZ;UAGHQ,MAAM,EAAEX,CAAC,CAACW,MAHP;UAIHC,KAAK,EAAEZ,CAAC,CAACY,KAJN;UAKHC,KAAK,EAAET,IAAI,CAACZ,IAAL,CAAUqB,KALd;UAMHC,IAAI,EAAEV,IAAI,CAACZ,IAAL,CAAUsB;QANb,CAAP;MAQH,CAZ+B,CAAZ,CAApB;MAcA1B,OAAO,CAACQ,KAAD,CAAP;MACAN,UAAU,CAAC,KAAD,CAAV;IACH,CAlBD,CAkBC,OAAOyB,CAAP,EAAU;MACPC,OAAO,CAACC,GAAR,CAAY;QAACF;MAAD,CAAZ;IACH,CApBD,SAoBS;MACLzB,UAAU,CAAC,KAAD,CAAV;IACH;EAEJ,CAzBD;;EA2BF,oBAAO;IAAA,wBACN,QAAC,MAAD;MAAA;MAAA;MAAA;IAAA,QADM,eAEN,QAAC,IAAD;MAAM,IAAI,EAAEH,IAAZ;MAAkB,KAAK,EAAC,UAAxB;MAAmC,OAAO,EAAEE;IAA5C;MAAA;MAAA;MAAA;IAAA,QAFM;EAAA;IAAA;IAAA;IAAA;EAAA,QAAP;AAID,CA7CD;;GAAMP,I;UAEyCJ,c,EACvBC,iB;;;KAHlBG,I;AA+CN,eAAeA,IAAf"},"metadata":{},"sourceType":"module"}